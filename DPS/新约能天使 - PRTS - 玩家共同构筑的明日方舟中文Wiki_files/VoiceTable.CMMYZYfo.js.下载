var e,l,a,o,i,t,d,n,r,s;import"./modulepreload-polyfill.YP0FEG5d.js";import{d as c,aw as v,f as u,r as p,i as m,H as b,c as f,o as y,b as g,k,e as w,p as h,j as x,w as T,q as K,s as L,t as _,F as A,m as B,P as C,bj as j}from"https://static.prts.wiki/widgets/production/vendor.Bx1BK1xJ.js";import{d as U,m as P,i as D}from"https://static.prts.wiki/widgets/production/common.CGUqtxLm.js";import{n as N,C as H}from"https://static.prts.wiki/widgets/production/naive-ui.BtEHr887.js";const I={class:"container"},M=["title","src"],E=["href","download"],V=["src"],q=c({__name:"VoicePlayer",props:{directLink:{},voiceId:{},voicePath:{},playKey:{}},emits:["update:playKey"],setup(e,{emit:l}){var a,o;const i=!decodeURIComponent(window.location.href).includes("/语音"),t=U("Pause.png"),d=U("Play.png"),n=U("Download.png"),r=e,s=l,c=null==(a=v())?void 0:a.vnode.key,h=u(()=>"//torappu.prts.wiki/assets/audio/".concat(r.voicePath)),x=u(()=>{var e;return null==(e=r.voiceId)?void 0:e.split("/").pop()}),T=u(()=>r.directLink||"".concat(h.value,"?filename=").concat(x.value,".wav")),K=p(!1),L=null!=(o=m("audioElem"))?o:new Audio;return b(()=>r.voicePath,()=>{K.value=!1,null==L||L.pause()}),b(()=>r.playKey,e=>{e!==c&&(K.value=!1)}),(e,l)=>(y(),f("div",I,[g("img",{class:"cursor-pointer <sm:w-7 md:w-10",title:K.value?"暂停":"播放",src:K.value?w(t):w(d),onClick:l[0]||(l[0]=()=>{K.value?(K.value=!1,null==L||L.pause()):(()=>{K.value=!0,L.src=r.directLink||h.value.replaceAll(".wav",".mp3"),s("update:playKey",c);const e=null==L?void 0:L.play();e&&e.catch(()=>{K.value=!1}),L.addEventListener("ended",()=>{K.value=!1})})()})},null,8,M),!i&&e.voicePath?(y(),f("a",{key:0,href:T.value,download:"".concat(x.value,".wav")},[g("img",{class:"cursor-pointer <sm:w-7 md:w-10",title:"下载",src:w(n)},null,8,V)],8,E)):k("",!0)]))}}),R={class:"max-w-screen-lg"},S={key:0,class:"mb-1 flex"},z={key:1,class:"overflow-hidden border border-divider rounded border-solid p-1 text-center font-bold shadow !bg-table"},F={class:"table border-collapse overflow-hidden border border-divider rounded border-solid bg-wikitable shadow"},O={class:"table-row-group"},G={class:"table-cell truncate border border-divider border-solid p-1 text-center align-middle font-bold !bg-table"},J={class:"w-full table-cell border border-divider rounded border-solid p-2 align-middle"},Q=["lang","innerHTML"],W={key:0},X={class:"table-cell truncate border border-divider rounded border-solid p-1 align-middle"},Y=c({__name:"VoiceTable",props:{tocTitle:{},voiceKey:{},voiceData:{},langArr:{default:()=>[]},voiceBase:{default:()=>[]}},setup(e){var l,a;const o=!decodeURIComponent(document.title).includes("/语音记录"),i=e,t=p(!0),d=p(["中文"]),n=p((null==(l=i.voiceBase[0])?void 0:l.path)||""),r=p((null==(a=i.voiceBase[0])?void 0:a.lang)||""),s=p(-1),c=(e,l)=>{n.value=e,r.value=l.lang||""};return h("audioElem",new Audio),(e,l)=>(y(),x(w(H),{"preflight-style-disabled":"",breakpoints:{s:640,m:768,lg:1024,xl:1280,xxl:1536},"theme-overrides":{common:{primaryColor:"#6a6aff"}}},{default:T(()=>[g("div",R,[o?k("",!0):(y(),f("div",S,[L(P,{label:"选择语音文本差分",class:"mr-2 flex-grow"},{default:T(()=>[L(w(N),{value:d.value,"onUpdate:value":l[0]||(l[0]=e=>d.value=e),multiple:"",options:e.langArr.map(e=>({label:e,value:e}))},null,8,["value","options"])]),_:1}),L(P,{label:"选择语音资源差分"},{default:T(()=>[L(w(N),{value:n.value,options:e.voiceBase,"label-field":"lang","value-field":"path","onUpdate:value":c},null,8,["value","options"])]),_:1})])),o?(y(),f("div",z,[g("span",null,_(e.tocTitle),1),g("a",{class:"z-1 float-right select-none",onClick:l[1]||(l[1]=()=>{t.value=!t.value})},_(t.value?"展开":"折叠"),1)])):k("",!0),K(g("div",F,[g("div",O,[(y(!0),f(A,null,B(e.voiceData,(a,o)=>{var i;return y(),f("div",{key:o,class:"table-row"},[g("div",G,_(a.title),1),g("div",J,[(y(!0),f(A,null,B(d.value,(e,l)=>(y(),f("p",{key:l},[g("span",{lang:e.includes("日文")?"ja":"",innerHTML:a.detail[e||"中文"]},null,8,Q),a.cond?(y(),f("b",W,"("+_(a.cond)+")",1)):k("",!0)]))),128))]),g("div",X,[(y(),x(q,{key:o,"play-key":s.value,"onUpdate:playKey":l[2]||(l[2]=e=>s.value=e),"direct-link":a.directLinks[r.value],"voice-id":"".concat(e.voiceKey,"/").concat(a.title),"voice-path":"".concat(n.value,"/").concat(null==(i=a.fileName)?void 0:i.replace(/\s/g,"_"))},null,8,["play-key","direct-link","voice-id","voice-path"]))])])}),128))])],512),[[C,!o||!t.value]])])]),_:1}))}}),Z={class:"max-w-screen-lg"},$={key:0,class:"mb-1 flex"},ee={key:1,class:"overflow-hidden border border-divider rounded border-solid p-1 text-center font-bold shadow !bg-table"},le={class:"table border-collapse overflow-hidden border border-divider rounded border-solid bg-wikitable shadow"},ae={class:"table-row-group"},oe={class:"flex truncate border border-divider border-solid p-1 align-middle font-bold !bg-table"},ie={class:"flex-auto self-center justify-self-center text-center"},te={class:"border border-divider border-solid p-2"},de=["lang","innerHTML"],ne={key:0},re=c({__name:"VoiceTableMobile",props:{tocTitle:{},voiceKey:{},voiceData:{},langArr:{default:()=>[]},voiceBase:{default:()=>[]}},setup(e){var l,a;const o=!decodeURIComponent(document.title).includes("/语音记录"),i=e,t=p(!0),d=p(["中文"]),n=p((null==(l=i.voiceBase[0])?void 0:l.path)||""),r=p((null==(a=i.voiceBase[0])?void 0:a.lang)||""),s=p(-1),c=(e,l)=>{n.value=e,r.value=l.lang||""};return h("audioElem",new Audio),(e,l)=>(y(),x(w(H),{"preflight-style-disabled":"",breakpoints:{s:640,m:768,lg:1024,xl:1280,xxl:1536},"theme-overrides":{common:{primaryColor:"#6a6aff"}}},{default:T(()=>[g("div",Z,[o?k("",!0):(y(),f("div",$,[L(P,{label:"选择语音文本差分",class:"mr-2 flex-grow"},{default:T(()=>[L(w(N),{value:d.value,"onUpdate:value":l[0]||(l[0]=e=>d.value=e),multiple:"",options:e.langArr.map(e=>({label:e,value:e}))},null,8,["value","options"])]),_:1}),L(P,{label:"选择语音资源差分"},{default:T(()=>[L(w(N),{value:n.value,options:e.voiceBase,"label-field":"lang","value-field":"path","onUpdate:value":c},null,8,["value","options"])]),_:1})])),o?(y(),f("div",ee,[g("span",null,_(e.tocTitle),1),g("a",{class:"z-1 float-right select-none",onClick:l[1]||(l[1]=()=>{t.value=!t.value})},_(t.value?"展开":"折叠"),1)])):k("",!0),K(g("div",le,[g("div",ae,[(y(!0),f(A,null,B(e.voiceData,(a,o)=>{var i;return y(),f("div",{key:o},[g("div",oe,[g("div",ie,_(a.title),1),g("div",null,[(y(),x(q,{key:o,"play-key":s.value,"onUpdate:playKey":l[2]||(l[2]=e=>s.value=e),"direct-link":null==a?void 0:a.directLinks[r.value],"voice-id":"".concat(e.voiceKey,"/").concat(null==a?void 0:a.title),"voice-path":"".concat(n.value,"/").concat(null==(i=null==a?void 0:a.fileName)?void 0:i.replace(/\s/g,"_"))},null,8,["play-key","direct-link","voice-id","voice-path"]))])]),g("div",te,[(y(!0),f(A,null,B(d.value,(e,l)=>(y(),f("p",{key:l},[g("span",{lang:e.includes("日文")?"ja":"",innerHTML:a.detail[e||"中文"]},null,8,de),a.cond?(y(),f("b",ne,"("+_(a.cond)+")",1)):k("",!0)]))),128))])])}),128))])],512),[[C,!o||!t.value]])])]),_:1}))}}),se=document.querySelector("#voice-table-root"),ce=document.querySelector("#voice-data-root"),ve=null==ce?void 0:ce.getElementsByClassName("voice-data-item"),ue=new Set,pe=(null==(l=null==(e=null==ce?void 0:ce.dataset)?void 0:e.voiceBase)?void 0:l.split(",").map(e=>{const[l,a]=e.split(":");return{lang:l,path:a}}))||[],me=Array.from(ve),be=[],fe=e=>{const l=null==e?void 0:e.split(","),a={};if(!l)return a;for(const o of l){const e=o.indexOf(":"),[l,i]=[o.slice(0,e),o.slice(e+1)];a[l]=i}return a},ye=e=>{var l;const a={},o=Array.from(e);for(const i of o)void 0!==(null==(l=i.dataset)?void 0:l.kindName)&&(a[i.dataset.kindName||""]=i.innerHTML,ue.add(i.dataset.kindName||""));return a};for(const we of me){if(!we.dataset)continue;const e=we.dataset.title,l=we.dataset.voiceIndex,i=null==(a=we.dataset.voiceFilename)?void 0:a.toLowerCase(),t=fe(we.dataset.directLinks),d=null==(o=we.dataset)?void 0:o.cond,n=ye(we.children);be.push({title:e,index:l,fileName:i,directLinks:t,cond:d,detail:n})}const ge=Array.from(ue);window.charVoice=be,console.log(ce,be,pe,ue);const ke=D();se&&(null==(i=null==ce?void 0:ce.dataset)?void 0:i.tocTitle)&&(null==(t=null==ce?void 0:ce.dataset)?void 0:t.voiceKey)&&be?ke?j(re,{tocTitle:null==(d=null==ce?void 0:ce.dataset)?void 0:d.tocTitle,voiceKey:null==(n=null==ce?void 0:ce.dataset)?void 0:n.voiceKey,voiceData:be,langArr:ge,voiceBase:pe}).mount(se):j(Y,{tocTitle:null==(r=null==ce?void 0:ce.dataset)?void 0:r.tocTitle,voiceKey:null==(s=null==ce?void 0:ce.dataset)?void 0:s.voiceKey,voiceData:be,langArr:ge,voiceBase:pe}).mount(se):console.error("voice-data or ele not found",se);
//# sourceMappingURL=https://static.prts.wiki/widgets/production/VoiceTable.CMMYZYfo.js.map
